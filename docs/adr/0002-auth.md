# 0002 - Autenticación y sesiones

- Status: Proposed
- Context: Roles diferenciados (ops global, staff tenant, alumno) con cookies httpOnly y claims JWT; MFA requerido para superadmin.
- Decision: JWT firmados por Payload; cookies `secure`/`httpOnly` + CSRF defensivo; claims mínimas (`sub`, `tenant_id`, `roles`/`enrollments`); middleware Next verifica tenant y roles; sin `DEV_AUTH_BYPASS` en prod.
- Consequences: Requiere issuer central y rotación de claves; middlewares deben fallar seguro si falta `tenant_id`; sesiones deben auditar logins y revocaciones.
